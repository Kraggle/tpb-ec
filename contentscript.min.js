var _e={ep:{},day:{}},changed=!1,urls=["https://pirateproxy.men","https://pirateproxy.bid","https://tpb.review","https://proxytorrent.xyz","https://tpbproxy.in","https://tpbmirror.org","https://thepiratebayproxy.net","https://piratesbay.me","https://ukpirateproxy.com","https://tpbunblock.net","https://unblocktpb.org","https://piratebaypirate.com","https://proxybay.life","https://piratebays.me","https://thepiratebay.click","https://fastpirate.link","https://gameofbay.eu","https://piratebays.be","https://ukbay.me","https://tpbship.org","https://opentpb.com","https://uktpbmirror.pw","https://fastbay.net","https://unblocktpb.pro","https://uktpbproxy.info","https://pirateproxy.sh","https://thepirateproxy.ws"],options,msgTimer,epList,dayList,downloading,index,testTime,oldHref="old",openTPB=new RegExp("1MtrxZFWz3FG9MobYWzxR2tRq4ybWJahmb","i"),magnetList=[],gettingMagnet=!1;function message(text){var mb=$(".app-message-box");mb.text(text).addClass("active"),msgTimer&&clearTimeout(msgTimer),msgTimer=setTimeout(function(){mb.removeClass("active")},1e4)}function addListener(){$('a[href!=""]').off("click").on("click",function(e){"https://episodecalendar.com"+$(this).attr("href")!=oldHref&&changeInterval(),addListener()});var cls=".epic-episode-marker-wrapper";$("body").off("click",cls).on("click",cls,function(){var box=$(this).closest(".calendar-day");$("input:not(:checked)",box).length?$(".calendar_date",box).removeClass("seen"):$(".calendar_date",box).addClass("seen"),refreshNotification()})}function changeInterval(){var oldBody=$("body")[0],int=setInterval(function(){window.location.href!=oldHref&&$("body")[0]==oldBody&&(check(),clearInterval(int)),oldBody=$("body")[0]},1e3)}function check(){oldHref=window.location.href;var now=new Date;if(now.setHours(23,59,59),dayList=[],cls=".epic-episode-marker-wrapper input:not(:checked)",$("body").hasClass("calendar")){var id=$("td.month h2").first().text()+"_"+$("p.year").first().text();_e.ep[id]||(_e.ep[id]=[]),epList=_e.ep[id],_e.day[id]||(_e.day[id]=[]),dayList=_e.day[id],$("#page_container .magnetized").length||(epList.length=0,$(".episode-item").each(function(i,el){ep=new episode,ep.id=$(this).attr("id"),ep.title=$(this).find(".show").text(),ep.episode=$(this).find(".episode").text().match(/\((S\d+E\d+)\)/)[1],ep.checked=$(this).hasClass("seen"),ep.released=$(this).find("input").length>0,epList.push(ep)}),$(".calendar_cell_content").each(function(i,el){var d=new day;d.id=$(this).attr("id"),d.released=$("input",this).length>0,0==$("input:not(:checked)",this).length&&d.head().addClass("seen"),dayList.push(d)}))}else if($("body").hasClass("unwatched")){var id=$(".cached-view:visible").attr("id");_e.ep[id]||(_e.ep[id]=[]),epList=_e.ep[id],$(".cached-view:visible .magnetized").length||(epList.length=0,$(".cached-view:visible .season").each(function(i,el){var season,title=$(this).find("h2").find("a").text().match(/(.*) - Season \d/)[1];$("<div />",{class:"separator"}).appendTo($(".epic-list-episode",this));var box=$("<div />",{class:"magnet-container center"}).appendTo($(".epic-list-episode",this));$("<div />",{class:"grey margin_bottom_mini"}).text("Magnet").appendTo(box),$(".epic-list-episode",this).each(function(j,eli){var ep=new episode;ep.id=$(this).attr("id"),ep.title=title,ep.episode=$(this).find(".mid_grey").find("strong").text(),ep.checked=!1;var date=$(this).find(".date").find("strong").text();ep.released=new Date(date).getTime()<now.getTime(),epList.push(ep)})}))}else if($("body").hasClass("show")){var id=$(".cached-view:visible").attr("id");if(_e.ep[id]||(_e.ep[id]=[]),epList=_e.ep[id],!$(".cached-view:visible .magnetized").length){epList.length=0,$("<div />",{class:"separator"}).appendTo($(".cached-view:visible .epic-list-episode"));var box=$("<div />",{class:"magnet-container center"}).appendTo($(".cached-view:visible .epic-list-episode"));$("<div />",{class:"grey margin_bottom_mini"}).text("Magnet").appendTo(box),title=$(".show_banner").find("h1").text(),$(".cached-view:visible .epic-list-episode").each(function(i,el){var ep=new episode;ep.id=$(this).attr("id"),ep.title=title,ep.episode=$(this).find(".mid_grey").find("strong").text();var check=$(this).find(".epic-episode-marker");ep.checked=check.length&&check.checked;var date=$(this).find(".date").find("strong").text();ep.released=new Date(date).getTime()<now.getTime(),epList.push(ep)})}}if($.each(epList,function(i,item){if(!item.get().hasClass("magnetized")&&item.released){var box=item.get().find(".magnet-container");(magnet=$("<div />",{class:box.length?"big magnet":"magnet",title:"Download!"}).attr("index",i).appendTo(box.length?box:item.get())).on("click",addToQueue),$("<div />",{class:"loader"}).hide().appendTo(magnet),item.get().addClass("magnetized")}else item.released||item.get().find(".magnet-container .grey").css("opacity",0)}),$.each(dayList,function(i,item){var magnet;!item.get().hasClass("magnetized")&&item.released&&($("<div />",{class:"magnet",title:"Download all unwatched from day!"}).attr("index",i).appendTo(item.head()).on("click",getDayMagnets),item.get().addClass("magnetized"))}),!$("#menu").hasClass("magnetized")){var magnet=$("<li />",{class:"download-all"}).appendTo($("#menu")),a;$("<a />",{id:"download-btn",href:""}).text("Download all").appendTo(magnet).on("click",getAllMagnets),$("<span />",{class:"menu-notification",id:"dl-count"}).text("0").appendTo(magnet),$("#menu").addClass("magnetized")}refreshNotification(),addListener()}function getAllMagnets(e){e.preventDefault(),$.each(epList,function(i,item){$("input:not(:checked)",item.get()).length&&addToQueue.call($(".magnet",item.get()).get(0))})}function getDayMagnets(e){var item=dayList[$(this).attr("index")];$(".magnet",item.get()).each(function(i,el){var item=epList[$(this).attr("index")];$("input",item.get()).is(":checked")||addToQueue.call($(".magnet",item.get()).get(0))})}function refreshNotification(){setTimeout(function(){$("body").hasClass("calendar")?$("#dl-count").text($(cls).length):$("#dl-count").text($(".cached-view:visible "+cls).length)},1e3)}function addToQueue(){$(this).off("click"),epList[$(this).attr("index")].get().find(".loader").fadeIn("250"),magnetList.push($(this).attr("index")),getMagnet.call(epList[magnetList[0]].get().find(".magnet"))}function getMagnet(e){if(!gettingMagnet){gettingMagnet=!0;var $this=$(this),item=epList[$(this).attr("index")],loader=item.get().find(".loader");console.log(item),chrome.storage.sync.get({quality:1,hevc:!0,check:!0,urls:urls,index:0},function(items){urls=(options=items).urls,index=options.index;var first=!0,html,testUrls=function(){chrome.runtime.sendMessage({url:urls[index]},function(a){if("string"===$.type(a.success)){var b=a.success.bMatch(openTPB);chrome.runtime.sendMessage({url:item.getQuery(b)},function(data){data.error?brokenLink("Broken: "+cleanURL(item.getQuery(b))):(html=data.success,"string"===$.type(data.success)&&data.success.bMatch(/value="Pirate Search"/i)&&$(".detLink",$(stripShit(data.success))).length>3?(chrome.storage.sync.set({index:index}),console.log("Found links @: "+cleanURL(item.getQuery(b))),resumeWork()):brokenLink("No links found @: "+cleanURL(item.getQuery(b))))})}else brokenLink("Broken: "+cleanURL(urls[index]))})},brokenLink=function(link=""){console.log(link),message(item.title+" "+item.episode+" not links found @ "+options.urls[index]),index=first&&0!=first?0:index+1,first=!1,index<urls.length?testUrls():(message("None of the links seem to be working, please try again later or replace them manually in options."),hideLoader($this,loader),getNextMagnet())},resumeWork=function(){if(item.download())download(item.download()),options.check&&$("input:not(:checked)",item.get()).click(),hideLoader($this,loader),getNextMagnet();else{var data=stripShit(html);$(".detLink",data).each(function(i,el){var href=urls[index]+$(this).attr("href").replace(/https{0,1}:\/\/\w+\.\w+/,"");href.bMatch(item.getRegex())&&(href.bMatch(/HEVC/i)?href.bMatch(/1080p/i)&&!item.m1080HEVC?item.m1080HEVC=href.replace(/(\d+)\/.+$/,"$1"):href.bMatch(/720p/i)&&!item.m720HEVC&&(item.m720HEVC=href.replace(/(\d+)\/.+$/,"$1")):href.bMatch(/1080p/i)&&!item.m1080?item.m1080=href.replace(/(\d+)\/.+$/,"$1"):href.bMatch(/720p/i)&&!item.m720?item.m720=href.replace(/(\d+)\/.+$/,"$1"):item.mStandard||(item.mStandard=href.replace(/(\d+)\/.+$/,"$1")))}),chrome.runtime.sendMessage({getLinks:!0,item:item},function(a){item.mStandard=a.item.mStandard||"",item.m720=a.item.m720||"",item.m1080=a.item.m1080||"",item.m720HEVC=a.item.m720HEVC||"",item.m1080HEVC=a.item.m1080HEVC||"",item.download()?(download(item.download()),options.check&&$("input:not(:checked)",item.get()).click(),refreshNotification()):message(item.title+" "+item.episode+" not found, please try again later!"),hideLoader($this,loader),getNextMagnet()})}};testUrls()})}}function getNextMagnet(){magnetList.shift(),gettingMagnet=!1,magnetList.length>0&&getMagnet.call(epList[magnetList[0]].get().find(".magnet"))}function cleanURL(url){return url.replace(/https{0,1}:\/\//,"")}function download(url){if(downloading)setTimeout(download,250,url);else{downloading=!0;var dl=window.open(url,"_blank");$(dl).on("onbeforeunload",function(){dl.opener.focus()}),setTimeout(function(){dl.close(),downloading=!1},200)}}function stripShit(data){return data.replace(/<(style|head|script).{0,}?>[\s\S]+?<\/(style|head|script)>/gi,"").replace(/<(link|img|meta).+?>/gi,"")}function isValid(url){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(url)}function hideLoader(el,loader){el.on("click",addToQueue),loader.fadeOut("250")}function episode(data){for(key in this.id,this.title,this.episode,this.checked,this.released,this.m1080,this.m1080HEVC,this.m720,this.m720HEVC,this.mStandard,this.get=function(){return $("#"+this.id)},this.getTitle=function(){return $.trim(this.title.replace(/the inhumans/i,"Inhumans").replace(/('s|'|\(\d+\)|\& )/g,""))},this.getQuery=function(open=!1){var s=this.getTitle().replace(/ |\./g,"+")+"+"+this.episode;return open?urls[index]+"/search/"+s:urls[index]+"/s/?q="+s},this.getQueryExtra=function(open=!1){var s=this.getTitle().replace(/ |\./g,"+")+"+"+this.episode;return open?urls[index]+"/search/"+s:urls[index]+"/s/?q="+s+"&category=0&page=0&orderby=99"},this.getRegex=function(){return new RegExp(this.getTitle().replace(/ /g,".+").replace(/S.H.I.E.L.D./,"(S.H.I.E.L.D|SHIELD)")+".+"+this.episode,"i")},this.download=function(){var q=options.quality;if(options.hevc){if((2==q||1==q&&!this.m720HEVC)&&this.m1080HEVC)return this.m1080HEVC;if((1==q||2==q)&&this.m720HEVC)return this.m720HEVC}if((2==q||1==q&&!this.m720)&&this.m1080)return this.m1080;if((1==q||2==q)&&this.m720)return this.m720;if(this.mStandard)return this.mStandard;if(0==q){if(options.hevc){if(this.m720HEVC)return this.m720HEVC;if(this.m1080HEVC)return this.m1080HEVC}if(this.m720)return this.m720;if(this.m1080)return this.m1080}},data)this[key]=data[key]}function day(){this.id,this.released,this.get=function(){return $("#"+this.id)},this.head=function(){return this.get().parent().find(".calendar_date")}}$(function(){addListener(),$("<div />",{class:"app-message-box"}).appendTo($("body")),changeInterval()}),function($){function isDOMAttrModifiedSupported(){var p=document.createElement("p"),flag=!1;if(p.addEventListener)p.addEventListener("DOMAttrModified",function(){flag=!0},!1);else{if(!p.attachEvent)return!1;p.attachEvent("onDOMAttrModified",function(){flag=!0})}return p.setAttribute("id","target"),flag}function checkAttributes(chkAttr,e){if(chkAttr){var attributes=this.data("attr-old-value");if(e.attributeName.indexOf("style")>=0){attributes.style||(attributes.style={});var keys=e.attributeName.split(".");e.attributeName=keys[0],e.oldValue=attributes.style[keys[1]],e.newValue=keys[1]+":"+this.prop("style")[$.camelCase(keys[1])],attributes.style[keys[1]]=e.newValue}else e.oldValue=attributes[e.attributeName],e.newValue=this.attr(e.attributeName),attributes[e.attributeName]=e.newValue;this.data("attr-old-value",attributes)}}var MutationObserver=window.MutationObserver||window.WebKitMutationObserver;$.fn.attrchange=function(a,b){if("object"==typeof a){var cfg={trackValues:!1,callback:$.noop};if("function"==typeof a?cfg.callback=a:$.extend(cfg,a),cfg.trackValues&&this.each(function(i,el){for(var attributes={},attr,i=0,attrs=el.attributes,l=attrs.length;i<l;i++)attributes[(attr=attrs.item(i)).nodeName]=attr.value;$(this).data("attr-old-value",attributes)}),MutationObserver){var mOptions={subtree:!1,attributes:!0,attributeOldValue:cfg.trackValues},observer=new MutationObserver(function(mutations){mutations.forEach(function(e){var _this=e.target;cfg.trackValues&&(e.newValue=$(_this).attr(e.attributeName)),void 0===$(this).data("attrchange-tdisconnect")&&cfg.callback.call(_this,e)})});return this.data("attrchange-method","Mutation Observer").data("attrchange-obs",observer).each(function(){observer.observe(this,mOptions)})}return isDOMAttrModifiedSupported()?this.data("attrchange-method","DOMAttrModified").on("DOMAttrModified",function(event){event.originalEvent&&(event=event.originalEvent),event.attributeName=event.attrName,event.oldValue=event.prevValue,void 0===$(this).data("attrchange-tdisconnect")&&cfg.callback.call(this,event)}):"onpropertychange"in document.body?this.data("attrchange-method","propertychange").on("propertychange",function(e){e.attributeName=window.event.propertyName,checkAttributes.call($(this),cfg.trackValues,e),void 0===$(this).data("attrchange-tdisconnect")&&cfg.callback.call(this,e)}):this}if("string"==typeof a&&$.fn.attrchange.hasOwnProperty("extensions")&&$.fn.attrchange.extensions.hasOwnProperty(a))return $.fn.attrchange.extensions[a].call(this,b)}}(jQuery),String.prototype.bMatch||(String.prototype.bMatch=function(regExp){var s;return null!==this.toString().match(regExp)});
//# sourceMappingURL=contentscript.min.js.map